<!doctype html>

{% import 'components/organisms/context-cards-overlay/context-cards-overlay.html' as context_overlay %}
{% import 'components/organisms/lightbox/lightbox.html' as lightbox %}
{% import 'components/structures/cookie-bar/cookie-bar.html' as cookie_bar %}
{% import 'components/structures/footer-bar/footer-bar.html' as footer_bar %}
{% import 'components/structures/grid-overlay/grid-overlay.html' as grid_overlay %}
{% import 'components/structures/menu-bar/menu-bar.html' as menu_bar %}
{% import 'components/structures/menu-overlay/menu-overlay.html' as menu_overlay %}
{% import 'components/structures/skip-to-main/skip-to-main.html' as skip_to_main %}

{% set cachebuster = '' if environment == 'development' else '?v=' + random_hash() %}

<html lang="de" class="{% if debug_grid %}debug-layout debug-grid debug-names{% endif %}">
  <head>
    <meta charset="utf-8">

    {# TODO: GOOGLE TAG MANAGER? #}

    <meta name="viewport" content="width=device-width, minimum-scale=1.0">
    <meta name="format-detection" content="telephone=no">

    <title>{% block page_title %}{% endblock %} â€” {{ site_name|default('') }}</title>
    <meta name="description" content="{{ site_description|default('') }}">

    <meta name="DC.Contributor" content="Fabrique">
    <link rel="DC.Contributor" href="https://www.fabrique.nl">

    <link rel="preload" href="{{ static }}/stylesheets/main.css{{ cachebuster }}" as="style">
    {#<link rel="preload" href="{{ static }}/scripts/base.js{{ cachebuster }}" as="script" crossorigin>#}
    <link rel="preload" href="{{ static }}/scripts/main.js{{ cachebuster }}" as="script" crossorigin>

    <meta property="og:title" content="{{ site_name }}">
    <meta property="og:url" content="{{ site_url }}">
    <meta property="og:image" content="{{ site_image }}">
    <meta property="og:description" content="{{ site_description }}">
    <meta property="og:site_name " content="{{ site_name }}">

    <meta name="application-name" content="{{ site_name }}"/>

    <link rel="icon" href="{{ static }}/images/favicons/favicon.ico{{ cachebuster }}">
    <link rel="icon" type="image/png" href="{{ static }}/images/favicons/favicon-32x32.png{{ cachebuster }}" sizes="192x192">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="{{ static }}/images/favicons/apple-touch-icon-152x152.png{{ cachebuster }}">

    <meta name="theme-color" content="#fff">
    <meta name="msapplication-TileColor" content="#fff">

    <link rel="stylesheet" href="{{ static }}/stylesheets/main.css{{ cachebuster }}">
  </head>

  <body class="{% block page_theme %}{% endblock %}">
    <script>{{ include_raw('build/static/scripts/base.js')|replace('\n;\n', '\n')|replace('\n//# sourceMappingURL=base.js.map', '') }}</script>
    {#<script src="{{ static }}/scripts/base.js{{ cachebuster }}" type="module" crossorigin></script>#}

    <div class="content">
      {{ skip_to_main.regular() }}
      {% block header_bar %}
        {{ menu_bar.regular(
          menu_items = [
            { href: '?', title: 'Die Sammlung' },
            { href: '?', title: 'Suchen in der Sammlung', icon_before: 'custom/ic_slash', icon_after: 'custom/ic_search' }
          ],
          address = 'Derzeit im Umbau, Bertha-Pappenheim-Platz 1',
          address2 = 'Heute geschlossen, Battonnstrasse 47',
          languages = ['Deutsche', 'English']
        ) }}
      {% endblock %}

      <header class="header" role="banner">
        {% block header %}
        {% endblock %}
      </header>

      <main id="main" class="main page-content" role="main">
        {% block content %}
        {% endblock %}
      </main>

      <footer class="footer" role="contentinfo">
        {% block footer_bar %}
          {{ footer_bar.simple(
            links = [
              { href: '?', title: 'Kontakt' },
              { href: '?', title: 'Impressum' },
              { href: '?', title: 'Datenschutz' },
              { href: '?', title: 'Barrierefreiheit' }
            ],
            context = true
          ) }}
        {% endblock %}

        {% block footer %}
        {% endblock %}
      </footer>
    </div>

    <div class="overlays" role="dialog">
      {% block overlays %}
      {% endblock %}

      {{ cookie_bar.regular() }}
    </div>

    {# Browser support for type=module is Chrome 61+, Firefox 60+, Edge 16+, Safari 10.1+, Opera 48+ #}
    {# Assume the fallback is executed for all other browsers and plan polyfills accordingly #}
    <script src="{{ static }}/scripts/main.js{{ cachebuster }}" type="module" crossorigin></script>
  </body>
</html>
